<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø­Ø¶ÙˆØ± Ø§Ù„ÙƒØ§Øª ÙƒØ§ÙÙŠÙ‡</title>

<style>
/* ******************** */
/* Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
/* ******************** */
body {
    margin: 0;
    font-family: "Tajawal", sans-serif;
    background: #0d0d0d;
    color: #fff;
}

/* Navbar */
.navbar {
    background: #1a1a1a;
    padding: 15px;
    font-size: 22px;
    text-align: center;
    letter-spacing: 1px;
    box-shadow: 0 0 10px #000;
}

/* Main container */
.container {
    width: 90%;
    max-width: 900px;
    margin: auto;
    margin-top: 30px;
}

/* Card UI */
.card {
    background: #151515;
    padding: 20px;
    border-radius: 15px;
    margin-bottom: 25px;
    box-shadow: 0 0 10px #000;
}

/* Forms */
input {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 10px;
    border: none;
    font-size: 17px;
    box-sizing: border-box; 
    background: #1a1a1a;
    color: white;
}

button {
    width: calc(50% - 5px); 
    padding: 12px;
    margin-top: 10px;
    border-radius: 10px;
    border: none;
    font-size: 17px;
    font-weight: bold;
    color: white;
    cursor: pointer;
    transition: background 0.3s;
}
.card button:nth-of-type(1) { /* ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ */
    background: #3d7fff;
    margin-left: 10px;
}
.card button:nth-of-type(2) { /* ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ */
    background: #ff4b4b;
}

.card button:nth-of-type(1):hover {
    background: #1b5ce6;
}
.card button:nth-of-type(2):hover {
    background: #cc3939;
}


/* Attendance */
.staff-box {
    background: #1a1a1a; 
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 8px;
    border: 1px solid #222;
}

.online { color: #00ff7b; }
.offline { color: #ff4b4b; }

/* Menu & Offers */
.table {
    width: 100%;
    margin-top: 15px;
    border-collapse: collapse;
    border-radius: 10px;
    overflow: hidden; 
}
.table th, .table td {
    padding: 12px;
    background: #1a1a1a; 
    border-bottom: 1px solid #333;
    text-align: center;
}
.table th {
    background: #1d1d1d;
    color: #3d7fff;
}
.table tr:nth-child(even) td {
    background: #151515; 
}
.table td:first-child {
    text-align: right;
    font-weight: bold;
}

/* Section titles (UPDATED) */
.section-title {
    font-size: 22px;
    margin-bottom: 10px;
    border-right: 4px solid #3d7fff;
    padding-right: 10px;
    /* Flexbox for alignment */
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Toggle Button Style */
.toggle-btn {
    background: none;
    border: 1px solid #3d7fff;
    color: #3d7fff;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    margin-left: 10px;
    flex-shrink: 0; /* Ù…Ù†Ø¹ Ø§Ù„Ø²Ø± Ù…Ù† Ø§Ù„Ø§Ù†ÙƒÙ…Ø§Ø´ */
    transition: all 0.2s;
}
.toggle-btn:hover {
    background: #3d7fff;
    color: #fff;
}

/* New CSS to hide content by default for toggling */
.content-hidden {
    display: none;
}
</style>

</head>
<body>

<div class="navbar">âœ¨ Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„ÙƒØ§Øª ÙƒØ§ÙÙŠÙ‡</div>

<div class="container">

    <div class="card">
        <div class="section-title">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>

        <input id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù">
        <input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

        <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
        <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>

        <p id="loginStatus" style="margin-top:15px;"></p>
    </div>

    <div class="card">
        <div class="section-title">
            ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ±
            <button class="toggle-btn" id="attendanceToggleBtn" onclick="toggleSection('attendanceContent', 'attendanceToggleBtn')">Ø¥Ø¸Ù‡Ø§Ø± â•</button>
        </div>
        <div id="attendanceContent" class="content-hidden">
            <div id="attendanceList"></div>
        </div>
    </div>

    <div class="card">
        <div class="section-title">
            â˜• Ø§Ù„Ù…Ù†ÙŠÙˆ
            <button class="toggle-btn" id="menuToggleBtn" onclick="toggleSection('menuContent', 'menuToggleBtn')">Ø¥Ø¸Ù‡Ø§Ø± â•</button>
        </div>
        <div id="menuContent" class="content-hidden">
            <table class="table" id="menuTable"></table>
        </div>
    </div>

    <div class="card">
        <div class="section-title">
            ğŸ”¥ Ø§Ù„Ø¹Ø±ÙˆØ¶
            <button class="toggle-btn" id="offersToggleBtn" onclick="toggleSection('offersContent', 'offersToggleBtn')">Ø¥Ø¸Ù‡Ø§Ø± â•</button>
        </div>
        <div id="offersContent" class="content-hidden">
            <table class="table" id="offersTable"></table>
        </div>
    </div>

</div>

<script>
// -----------------------
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)
// -----------------------
const staff = [
    { username: "Adel", password: "1111", rank: "Cafe Manager", phone: "(480) 362-1217" },
    { username: "Raed", password: "2222", rank: "New Barista", phone: "9999" },
    { username: "Ahmed", password: "3333", rank: "Cat Care Specialist", phone: "666666" },
    { username: "bandr", password: "4444", rank: "Security Supervisor", phone: "(520) 481-4142" },
    { username: "SAUD", password: "5555", rank: "Inventory Controller", phone: "0003" },
    { username: "Yazeed", password: "6666", rank: "Kitchen Manager", phone: "(205) 196-3375" },
    { username: "Abu Noura", password: "7777", rank: "Customer Relations", phone: "(205) 929-1911" },
    { username: "Dazal", password: "8888", rank: "Cafe Engineer", phone: "0007" },
    { username: "Lux", password: "8888", rank: "Cafe Engineer", phone: "-" },
    { username: "uae", password: "9999", rank: "Barista Chief", phone: "(205) 666-1846" },
    { username: "saleh", password: "0000", rank: "Quality Assurance", phone: "(602) 735-9109" },
];

// -----------------------
// Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ± (ØªÙØ®Ø²Ù† ÙÙŠ localStorage)
// -----------------------
let states = {}; // keyed by username
const STORAGE_KEY = 'catcafe_attendance_states_v1';
const WEBHOOK_URL = "https://ptb.discord.com/api/webhooks/1446095428977299558/_TCIsd_8kj9uNMzYkVE1gN5_A-SA_AopYsQhJty-KhjLGnVjGCF6IKpVBCiUHwuZOqFB"; 

function loadStates() {
    try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return;
        const parsed = JSON.parse(raw);
        Object.keys(parsed).forEach(k => {
            const userState = parsed[k];
            const exists = staff.find(s => s.username === k);
            if (exists) states[k] = userState;
        });
    } catch (e) {
        console.error("ÙØ´Ù„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§Ù„Ø§Øª:", e);
    }
}

function saveStates() {
    try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(states));
    } catch (e) {
        console.error("ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø§Øª:", e);
    }
}

// -----------------------
// Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ÙˆÙ‚Øª
// -----------------------
function msToHMS(ms) {
    if (!ms || ms < 0) return '00:00:00';
    const total = Math.floor(ms / 1000);
    const h = Math.floor(total / 3600);
    const m = Math.floor((total % 3600) / 60);
    const s = total % 60;
    return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

function formatShortDate(ms) {
    if (!ms) return '---';
    const d = new Date(ms);
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const hh = String(d.getHours()).padStart(2,'0');
    const min = String(d.getMinutes()).padStart(2,'0');
    return `${dd}/${mm} ${hh}:${min}`;
}


// -----------------------
// Ø¯ÙˆØ§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø§Ù„Ø®Ø±ÙˆØ¬
// -----------------------
function login() {
    const uname = document.getElementById('username').value.trim();
    const pass = document.getElementById('password').value.trim();
    const statusEl = document.getElementById('loginStatus');

    if (!uname || !pass) {
        statusEl.style.color = 'orange';
        statusEl.innerText = 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
        return;
    }

    const account = staff.find(s => s.username === uname && s.password === pass);
    if (!account) {
        statusEl.style.color = 'red';
        statusEl.innerText = 'âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
        return;
    }

    if (states[uname] && states[uname].status === 'online') {
        statusEl.style.color = 'orange';
        statusEl.innerText = `âš ï¸ ${uname} Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„ÙØ¹Ù„`;
        return;
    }

    states[uname] = {
        username: uname,
        status: 'online',
        loginMS: Date.now(),
        logoutMS: null,
        rank: account.rank,
        phone: account.phone
    };

    saveStates();
    updateAttendanceList();

    statusEl.style.color = '#0f0';
    statusEl.innerText = `âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ${uname}`;
    
    sendWebhookEmbed(states[uname], "login");
}

function logout() {
    const uname = document.getElementById('username').value.trim();
    const statusEl = document.getElementById('loginStatus');

    if (!uname) {
        statusEl.style.color = 'orange';
        statusEl.innerText = 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
        return;
    }

    const st = states[uname];
    if (!st || st.status !== 'online') {
        statusEl.style.color = 'orange';
        statusEl.innerText = `âš ï¸ ${uname} Ù„ÙŠØ³ Ù…Ø³Ø¬Ù„Ø§Ù‹ Ø¯Ø®ÙˆÙ„ Ø­Ø§Ù„ÙŠÙ‹Ø§`;
        return;
    }

    const logoutTimeMS = Date.now();
    const durationMS = logoutTimeMS - st.loginMS;
    const sessionTime = msToHMS(durationMS); 

    states[uname].status = 'offline';
    states[uname].logoutMS = logoutTimeMS;

    saveStates();
    updateAttendanceList();

    statusEl.style.color = '#ffb347';
    statusEl.innerText = `ğŸ”¸ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ ${uname}`;

    sendWebhookEmbed(states[uname], "logout", sessionTime);
}

// -----------------------
// Ø¯Ø§Ù„Ø© Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©
// -----------------------
function sendWebhookEmbed(staffObj, actionType, sessionTime = null) {
    if (WEBHOOK_URL === "Ø¶Ø¹_Ø±Ø§Ø¨Ø·_Ø§Ù„ÙˆÙŠØ¨_Ù‡ÙˆÙƒ_Ù‡Ù†Ø§" || !WEBHOOK_URL) {
        console.warn("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Webhook: ÙŠØ±Ø¬Ù‰ ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Webhook ØµØ§Ù„Ø­.");
        return;
    }
    
    const embedColor = actionType === "login" ? 0x2ECC71 : 0xE74C3C;
    const actionText = actionType === "login" ? "ğŸŸ¢ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„" : "ğŸ”´ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬";
    
    const fields = [
        { name: "ğŸ‘¤ Ø§Ù„Ù…ÙˆØ¸Ù", value: staffObj.username, inline: true },
        { name: "ğŸ–ï¸ Ø§Ù„Ø±ØªØ¨Ø©", value: staffObj.rank, inline: true },
        { name: "ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù", value: staffObj.phone || "-", inline: true },
    ];
    
    if (sessionTime) {
        fields.push({
            name: "âŒ› Ù…Ø¯Ø© Ø§Ù„Ø¯ÙˆØ§Ù…",
            value: sessionTime,
            inline: false
        });
    }

    fields.push({
        name: "â° Ø§Ù„ÙˆÙ‚Øª",
        value: new Date().toLocaleString("ar-SA"),
        inline: false
    });

    const data = {
        embeds: [
            {
                title: actionText,
                color: embedColor,
                fields: fields,
                footer: {
                    text: "Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„ÙƒØ§Øª ÙƒØ§ÙÙŠÙ‡"
                },
                timestamp: new Date().toISOString()
            }
        ]
    };

    fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    })
    .catch(error => console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ:", error));
}


// -----------------------
// ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¶ÙˆØ±
// -----------------------
function updateAttendanceList() {
    const container = document.getElementById('attendanceList');
    if (!container) return; // Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø®Ø·Ø£ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø¹Ù†ØµØ± Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹

    container.innerHTML = '';

    const ordered = [...staff].sort((a,b) => {
        const sa = states[a.username] && states[a.username].status === 'online' ? 0 : 1;
        const sb = states[b.username] && states[b.username].status === 'online' ? 0 : 1;
        if (sa !== sb) return sa - sb;
        return a.username.localeCompare(b.username);
    });

    ordered.forEach(s => {
        const st = states[s.username] || { status: 'offline', loginMS: null, logoutMS: null };
        const div = document.createElement('div');
        div.className = 'staff-box';

        const statusSpan = st.status === 'online' ? `<span class="online">Ù…ØªØµÙ„ ğŸŸ¢</span>` : `<span class="offline">ØºÙŠØ± Ù…ØªØµÙ„ ğŸ”´</span>`;

        let elapsed = '---';
        if (st.status === 'online' && st.loginMS) {
            elapsed = msToHMS(Date.now() - st.loginMS);
        } else if (st.logoutMS && st.loginMS) {
            elapsed = msToHMS(st.logoutMS - st.loginMS);
        }

        const loginTime = st.loginMS ? formatShortDate(st.loginMS) : '---';
        const logoutTime = st.logoutMS ? formatShortDate(st.logoutMS) : '---';

        div.innerHTML = `
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <div style="text-align:right;">
                    <div><strong>${s.username}</strong> â€” <small>${s.rank}</small></div>
                    <div style="color:#bbb;font-size:13px;">ğŸ“ ${s.phone || '-'}</div>
                </div>
                <div style="text-align:left; min-width:140px;">
                    ${statusSpan}<br>
                    <small style="color:#999">Ù…Ø¯Ø©: ${elapsed}</small>
                </div>
            </div>
            <div style="margin-top:8px; color:#8a8a8a; font-size:13px;">
                Ø¯Ø®ÙˆÙ„: ${loginTime} &nbsp; | &nbsp; Ø®Ø±ÙˆØ¬: ${logoutTime}
            </div>
        `;

        container.appendChild(div);
    });
}

// ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
setInterval(updateAttendanceList, 1000);


// -----------------------------
// Ø§Ù„Ù…Ù†ÙŠÙˆ ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ (ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„)
// -----------------------------
const menuItems = [
    { name: "Latte", desc: "Ù‚Ù‡ÙˆØ© Ù„Ø§ØªÙŠÙ‡ Ø¨Ø§Ù„Ø­Ù„ÙŠØ¨", price: "12 Ø±ÙŠØ§Ù„" },
    { name: "Cappuccino", desc: "ÙƒØ§Ø¨ØªØ´ÙŠÙ†Ùˆ ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ", price: "13 Ø±ÙŠØ§Ù„" },
    { name: "Spanish Latte", desc: "Ø§Ø³Ø¨Ø§Ù†ÙŠØ´ Ù„Ø§ØªÙŠÙ‡ Ø¨Ø§Ø±Ø¯", price: "15 Ø±ÙŠØ§Ù„" },
    { name: "Hot Chocolate", desc: "Ù‡ÙˆØª Ø´ÙˆÙƒÙ„Øª", price: "10 Ø±ÙŠØ§Ù„" },
    { name: "Mocha", desc: "Ù…ÙˆÙƒØ§ Ø³Ø§Ø®Ù†", price: "14 Ø±ÙŠØ§Ù„" },
];

const offers = [
    { title: "Ø¨Ø§Ù‚Ø© 65 ÙƒÙˆØ¨", desc: "Ø§Ø®ØªØ± Ù…Ø§ ØªØ´Ø§Ø¡ Ù…Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª", price: "6000 Ø±ÙŠØ§Ù„" },
    { title: "Ø¨Ø§Ù‚Ø© 45 ÙƒÙˆØ¨", desc: "Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„ÙØ±Ù‚ Ø§Ù„ØµØºÙŠØ±Ø©", price: "4000 Ø±ÙŠØ§Ù„" },
    { title: "Ø¨Ø§Ù‚Ø© 30 ÙƒÙˆØ¨", desc: "Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© ÙˆÙ…Ù…ØªØ§Ø²Ø©", price: "3000 Ø±ÙŠØ§Ù„" },
];

function loadMenu() {
    const table = document.getElementById("menuTable");
    if (!table) return;

    table.innerHTML = `
        <tr>
            <th>Ø§Ù„Ù…Ø´Ø±ÙˆØ¨</th>
            <th>Ø§Ù„ÙˆØµÙ</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
        </tr>
    `;

    menuItems.forEach(item => {
        table.innerHTML += `
            <tr>
                <td>${item.name}</td>
                <td>${item.desc}</td>
                <td>${item.price}</td>
            </tr>
        `;
    });
}

function loadOffers() {
    const table = document.getElementById("offersTable");
    if (!table) return;

    table.innerHTML = `
        <tr>
            <th>Ø§Ù„Ø¹Ø±Ø¶</th>
            <th>Ø§Ù„ÙˆØµÙ</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
        </tr>
    `;

    offers.forEach(of => {
        table.innerHTML += `
            <tr>
                <td>${of.title}</td>
                <td>${of.desc}</td>
                <td>${of.price}</td>
            </tr>
        `;
    });
}

// -----------------------
// Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Accordion Logic)
// -----------------------
function toggleSection(contentId, buttonId) {
    const content = document.getElementById(contentId);
    const button = document.getElementById(buttonId);

    if (content.classList.contains('content-hidden')) {
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        content.classList.remove('content-hidden');
        button.innerText = 'Ø¥Ø®ÙØ§Ø¡ â–';
    } else {
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        content.classList.add('content-hidden');
        button.innerText = 'Ø¥Ø¸Ù‡Ø§Ø± â•';
    }
}


// -----------------------
// Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
// -----------------------
(function init() {
    loadStates();
    updateAttendanceList();
    loadMenu(); 
    loadOffers();

    // optional: pre-fill last username (if exist)
    try {
        const lastUser = localStorage.getItem('catcafe_last_user');
        if (lastUser) document.getElementById('username').value = lastUser;
    } catch(e){}

    // store last used username on login/logout attempts
    const loginBtn = document.querySelector('button[onclick="login()"]');
    const logoutBtn = document.querySelector('button[onclick="logout()"]');
    
    if (loginBtn) loginBtn.addEventListener('click', () => {
        const u = document.getElementById('username').value.trim();
        if (u) localStorage.setItem('catcafe_last_user', u);
    });
    
    if (logoutBtn) logoutBtn.addEventListener('click', () => {
        const u = document.getElementById('username').value.trim();
        if (u) localStorage.setItem('catcafe_last_user', u);
    });
})();
</script>

</body>
</html>
